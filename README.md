# WEB APPLICATION WITH REACT AND REDUX

Based on the web [tutorial series](https://www.youtube.com/playlist?list=PLuNEz8XtB51K-x3bwCC9uNM_cxXaiCcRY) by Rem Zolotykh.


## START WITH:
Lesson 11


#### To Run:
```
$ npm run server
```

#### To Stop (on Windows):
```
Ctrl-c
$ taskkill /F /IM node.exe
```

### HELPFUL RESOURCES:
* [webpack configuration guide](https://webpack.js.org/configuration/)
* don't forget that you can use the react and redux extensions in dev tools to examine the composition and state of your react components
    - the redux extension will help debug what's going on with reducers and track state changes


## PROJECT NOTES:

#### APPLICATION OVERVIEW:
* our login application consists of the main app layout component, nav bar, greeting and signup form, the display of which is controlled by routing.
* **validation**:
    - both client- and server-side
    - in `SignupForm::onSubmit()` we use the check to `isValid()` which calls our validation func right there on the client side. if we didn't validate there, it would happen when we call `userSignupRequest()` which makes a server call (where validation takes place again)


#### PACKAGE.JSON
* `scripts: nodemon` watches the server directory for changes and refreshes its execution of `babel-node`
    - `nodemon` is handling the filename `index.js`, not `babel-node`, hence the '--'
    - webpack will take care of the client directory

#### WEBPACK CONFIG
* webpack can take any file (`path: '/'`) because middleware serves from memory (rather than saving a file like 'bundle.js')
* `devtool: 'eval-source-map'` provides more information while debugging making it easier to track down errors
* webpack doesn't know anything about js (or other languages) so the `rules` array tells webpack how to handle certain kinds of files
    - `test` certain file extensions
    - `include` only from a certain directory
    - `loader` using the appropriate loader
* `entry` must be an array as it is used both to serve up the client directory but also it is used by the express middleware
* plugins:
    - `HotModuleReplacementPlugin`: most important
    - `NoEmitOnErrorsPlugin`: cleaner errors


#### REDUX
* we will use redux for store management and actions
* actions
    - Redux takes care of dispatching actions based on events
    - our components just call functions with data passed in w/out needing to know what's going on
* we don't need to store anything in global Redux store for now -- we just need actions
* `connect` is a high-order component needed to connect redux actions with React components (?)
    - connect takes two params:
        * map state to props: provides some piece of data from Store (takes state and returns object)
        * map page to props: specify your action here (userSignupRequest)
    - `FlashMessagesList` is connected because it will need information from the Store
            - shorcut definition is to create it as an object `{ userSignupRequest }`
* **reducers** are simple functions which take state and an action and return a state
    - keep reducers small and simple
    - we use the `combineReducers` helper from redux to combine and manage all of our reducers as one state object


#### BABELRC
* babel does the transpiling of ES6 code
* babel doesn't understand react by default, so add that in there too

#### INDEX.HTML
* the script src is 'bundle.js' but there's no such file in our project. that's because the file is dynamically generated by webpack and served up to the browser

#### INDEX.JS (SERVER)
* define the interface between our express server and our entry point ('index.html')
* configuring webpack
    - we use the webpack config file from our root dir by importing the file and creating `const compiler`
    - then we add configuration specifically for webpackMiddleware with our `app.use()` statements
    - 'noInfo' reduces noise from webpack
* hot middleware is needed for using express

#### INDEX.JS (CLIENT)
* here is where we render the components that will go into 'bundle.js'
* introducing routes:
    - rather than loading the `App` component, we will use `Router` to show different content based on different conditions (are we logged in or out?)
    - your router needs `browserHistory`
    - the routes themselves are saved in a separate file ('routes.js')
* the `Router` component will be wrapped in `Provider` -- our basic Redux store
* Redux `store` and `Provider`:
    - `Provider`
    - `store` is a more broad Redux construct
        * initialized with the `createStore` function from Redux which takes several params:
            - root reducer: a function which takes state and action and returns a new state
            - second param is optional initial state
            - third param is applyMiddleware (provided by Redux)
* `thunk` middleware from Redux allows us to dispatch asynchronous actions

#### APP.JS
* _your top component must be a class component rather than a functional component_
    ```javascript
    // CLASS COMPONENT:
    class App extends React.Component {
        render() {
            return (
                <h1>Hello Mars!</h1>
            );    
        }
    }
    export default App;
    // VERSUS THE FUNCTIONAL:
    export default () => {
        return (
            <h1>Greetings, Venus!</h1>
        );
    }
    ```
* because our app uses several different components as 'top' components depending on routing, all of our router components need to be classes (App, Greetings, SignupPage)


#### ROUTES.JS
* your route requires two props:
    - the path
    - the component being rendered
* `IndexRoute` is like a default root route -- "when nothing else is specified, display this"



#### SIGNUPFORM
* this handles all the higher-level stuff that is separate from the form itself
* our form will need state and needs to be a class component
* onSubmit:
    - will be defined separately in `actions/`
    - will be imported by `SignupPage` and passed to `SignupForm` via props


#### SIGNUPPAGE
* the actual form
* use `lodash/map` function to create a key/value mapping of timezones
* `onChange` function is intentionally generic so it can be used with any of the fields
* `SignupPage` is passed in `userSignupRequest` which comes from Redux thunk, but we need to use `connect` to get it


#### SIGNUPACTIONS
* `return dispatch` - our promise


#### SERVER/USERS
* here is where we will validate our user data and handle errors using `Validator`
* note that `Validator.isNull()` is deprectated -- use `Validator.isEmpty()` or `lodash.isEmpty()`



Quick updates : - with React now you can use the tag ref="username" then you can access the element with this.refs.username so you can just setState onSubmit this.refs.username.value. - with ES6/2015 you are not always forced to bind the context, you can instead use the arrow function so the context of the function is automatically the one where the function is called!
Ex: onChange={ this.onChange.bind(this) }
becomes
onChange={ (ev) => this.onChange(ev) }ï»¿


## TO DO:
* routes don't actually live in the routes file -- make it so
* reverted axios to an older version (0.12.0) - update for newer axios version
* why do some of our import variables go inside brackets and others don't?
* perhaps deprecated use of contextTypes in SignupForm -- rework
